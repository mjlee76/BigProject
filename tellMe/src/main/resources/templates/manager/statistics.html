<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="en">
<head th:replace="layouts/navbar::tellMe_head"/>
<head th:replace="layouts/footer::tellMe_foot"/>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>통계 게시판</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="stylesheet" type="text/css" th:href="@{/css/statistics.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/sidebar.css}" />
<link href="https://cdn.jsdelivr.net/gh/sun-typeface/SUIT@2/fonts/static/woff2/SUIT.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script> <!-- Ensure this plugin is loaded -->
<script th:src="@{/js/statistics.js}"></script>
</head>
<body>
<div th:replace="layouts/navbar::tellMe_header"></div>

<!-- ✅ 사이드바 -->
<div id="wrapper">
    <!-- Sidebar -->
    <ul class="sidebar bg-primary sidebar-dark" id="sidebar">
        <!-- Sidebar Content -->
    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper">
        <!-- 처리 대기중 민원수 -->
        <div id="status-content" style="display: block;">
            <h2 class="text-center">처리 대기중 민원수</h2>
            <div class="chart-wrapper">
                <canvas id="statusChart"></canvas>
            </div>
        </div>

        <!-- 보고서 확인 상태별 통계 -->
        <div id="reportstatus-content" style="display: block;">
            <h2 class="text-center">보고서 상태별 통계</h2>
            <div class="chart-wrapper">
                <canvas id="reportstatusChart"></canvas>
            </div>
        </div>

    </div>

</div>

<div th:replace="layouts/footer::tellMe_footer"></div>

<script>
    // 민원 처리 상태별 파이 차트
    var ctx = document.getElementById('statusChart').getContext('2d');
    var statusChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['접수중', '처리중'],
            datasets: [{
                label: '민원 수',
                data: [
                    /* 통계 데이터 (서버에서 전달된 값으로 대체됨) */
                    [[${statistics.접수중Count}]],
                    [[${statistics.처리중Count}]]
                ],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    color: 'white', // 라벨의 텍스트 색상
                    font: {
                        size: 14, // 폰트 크기
                        weight: 'bold' // 폰트 두께
                    },
                    formatter: function(value) {
                        return value;  // 백분율 대신 값만 표시
                    }
                }
            }
        }
    });

    // 보고서 상태별 파이 차트
    var reportCtx = document.getElementById('reportstatusChart').getContext('2d');
    var reportstatusChart = new Chart(reportCtx, {
        type: 'pie',
        data: {
            labels: ['미확인', '확인완료'],
            datasets: [{
                label: '보고서 수',
                data: [
                    /* 통계 데이터 (서버에서 전달된 값으로 대체됨) */
                    [[${statistics.미확인Count}]],
                    [[${statistics.확인완료Count}]]
                ],
                backgroundColor: [
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(75, 192, 192, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 159, 64, 1)',
                    'rgba(75, 192, 192, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    color: 'white', // 라벨의 텍스트 색상
                    font: {
                        size: 14, // 폰트 크기
                        weight: 'bold' // 폰트 두께
                    },
                    formatter: function(value) {
                        return value;  // 백분율 대신 값만 표시
                    }
                }
            }
        }
    });
</script>
</body>
</html>
